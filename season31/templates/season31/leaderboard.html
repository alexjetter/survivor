{% load staticfiles %}

<link rel="stylesheet" type="text/css" href="{% static 'season31/style.css' %}" />

<table class="marg0 pad0 noborder"><tr>

	<td class="menu noborder texttop">
		{% include "season31/menu.html" %}
	</td>
	<td class="content noborder texttop textleft">

		<div class="halftitle textcenter">Leaderboard</div>
		
		{% if latestepisode %}
		<div class="textcenter">{{ latestepisode }}</div>
		{% endif %}

		<table>
			<tr>
				<td class="columnheader fglightgrey">±</td>
				<td class="columnheader fglightgrey">Plc</td>
				<td class="columnheader fglightgrey">Player</td>
				<td class="columnheader fglightgrey">Pts</td>
				<td class="columnheader"></td>
				<td class="columnheader fglightgrey">{% if latestepisode %}{{ latestepisode.short }}{% else %}Week{% endif %}</td>
				<td class="columnheader"></td>
				<td class="columnheader fglightgrey">Team</td>
			</tr>
			{% for playerepisode in playerepisodes %}
			<tr>
				<td class="columnheader{% if playerepisode.movement > 0 %} fggreen5{% elif playerepisode.movement < 0 %} fgred5{% endif%}">{{ playerepisode.movement }}</td>
				<td>{{ playerepisode.place }}</td>
				<td class="columnheader fgwhite"><a href="{% url 'season31:player' playerepisode.player.id %}" class="fgwhite">{{ playerepisode.player }}</a></td>
				<td>{{ playerepisode.total_score }}</td>
				<td class="columnheader"></td>
				<td>{{ playerepisode.week_score }}</td>
				<td class="columnheader"></td>
				<td class="pad0 marg0">
					{% if playerepisode.episode.is_locked %}
					{% for pick in playerepisode.get_team_picks %}
					<div class="{% if pick.out_this_episode %}out{% else %}bgtribe{{ pick.castaway_episode.tribe.color }}{% endif %} floatleft padtb1 marg0 pickwidth" title="{{ pick.castaway }}">
						<a href="{% url 'season31:castaway' pick.castaway.id %}" class="fgblack marg0">
							{{ pick.castaway }}
						</a>
					</div>
					{% endfor %}
					{% endif %}
				</td>
			</tr>
			{% endfor %}
		</table>
	</td>
	{% if user.is_superuser  %}
	<td class="bgadmin marg0 pad0 noborder texttop">

		<div class="bgwhite pad4 marg4">
			<form action="{% url 'season31:addepisode' %}" method="post">
				{% csrf_token %}
				<div>
					<input type="number" name="teamsize" id="teamsize" min="2" max="10" value="{{ latestepisode.team_size }}" />
					<label for="teamsize">Team Size</label>
				</div>
				<input type="submit" class="width100" value="Add Episode" />
			</form>
		</div>
		<div class="bgwhite pad4 marg4">
			<form action="{% url 'season31:backfillteams' %}" method="post">
				{% csrf_token %}
				<input type="submit" class="width100" value="Backfill Teams" />
			</form>
		</div>
		<div class="bgwhite pad4 marg4">
			<form action="{% url 'season31:tallyalljsps' %}" method="post">
				{% csrf_token %}
				<input type="submit" class="width100" value="Tally All JSPs" />
			</form>
		</div>
		<div class="bgwhite pad4 marg4">
			<form action="{% url 'season31:updatescores' %}" method="post">
				{% csrf_token %}
				<input type="submit" class="width100" value="Recalculate All Scores" />
			</form>
		</div>
	</td>
	{% endif %}
	
</tr></table>