{% load staticfiles %}

<link rel="stylesheet" type="text/css" href="{% static 'season31/style.css' %}" />

<table class="noborder"><tr>

	<td class="menu noborder texttop">
		{% include "season31/menu.html" %}
	</td>
	<td class="content noborder texttop textleft">
		
		{% if latestepisode %}
		
		<div class="title">{{ latestepisode }}</div>
		
		<div class="halfspacer"></div>
		
		
		<div class="bgdarkgrey rounded pad2">
			<div class="textleft fglightgrey font24 pad4 rounded marg1">Stats</div>
			<table class="textcenter">
				<tr>
					<td class="bgblack  padlr4 textright fglightgrey">Top Castaway Score</td>
					<td class="bggreen4 padlr4 textcenter">{{ simpleepisodestats.topcastawayscore }}</td>
					<td class="bgblack  padlr4 textleft fggreen4">Points</td>
					<td class="bgblack textleft">
						{% for sp in simpleepisodestats.topcastawayscorers %}
						<div class="inline padlr4 marglrneg2 bg{{ sp.color }}"><a href="{% url 'season31:castaway' sp.id %}">{{ sp.name }}</a></div>
						{% endfor %}
					</td>
				</tr>
				<tr>
					<td class="bgblack  padlr4 textright fglightgrey">Most Picked for Teams</td>
					<td class="bggreen4 padlr4 textcenter">{{ simpleepisodestats.mostteamcastawaycount }}</td>
					<td class="bgblack  padlr4 textleft fggreen4">Teams</td>
					<td class="bgblack textleft">
						{% for sp in simpleepisodestats.mostteamcastaways %}
						<div class="inline padlr4 marglrneg2 bg{{ sp.color }}"><a href="{% url 'season31:castaway' sp.id %}">{{ sp.name }}</a></div>
						{% endfor %}
					</td>
				</tr>
				<tr>
					<td class="bgblack  padlr4 textright fglightgrey">Most Predicted Vote-Off</td>
					<td class="bgred4   padlr4 textcenter">{{ simpleepisodestats.mostvotecastawaycount }}</td>
					<td class="bgblack  padlr4 textleft fgred4">Picks</td>
					<td class="bgblack textleft">
						{% for sp in simpleepisodestats.mostvotecastaways %}
						<div class="inline padlr4 marglrneg2 bg{{ sp.color }}"><a href="{% url 'season31:castaway' sp.id %}">{{ sp.name }}</a></div>
						{% endfor %}
					</td>
				</tr>
				<tr>
					<td class="bgblack  padlr4 textright fglightgrey">Top Player Score</td>
					<td class="bggreen4 padlr4 textcenter">{{ simpleepisodestats.topplayerscore }}</td>
					<td class="bgblack  padlr4 textleft fggreen4">Points</td>
					<td class="bgblack textleft">
						{% for sp in simpleepisodestats.topplayerscorers %}
						<div class="inline padlr4 marglrneg2"><a href="{% url 'season31:player' sp.id %}" class="fgwhite">{{ sp.name }}</a></div>
						{% endfor %}
					</td>
				</tr>
				{% if simpleepisodestats.topplayermovement > 0 %}
				<tr>
					<td class="bgblack  padlr4 textright fglightgrey">Most Spots Climbed</td>
					<td class="bggreen4 padlr4 textcenter">+{{ simpleepisodestats.topplayermovement }}</td>
					<td class="bgblack  padlr4 textleft fggreen4">Places</td>
					<td class="bgblack textleft">
						{% for sp in simpleepisodestats.topplayermovers %}
						<div class="inline padlr4 marglrneg2"><a href="{% url 'season31:player' sp.id %}" class="fgwhite">{{ sp.name }}</a></div>
						{% endfor %}
					</td>
				</tr>
				{% endif %}
				<tr>
					<td class="bgblack  padlr4 textright fglightgrey">Correct Vote Predictions</td>
					<td class="bggreen4 padlr4 textcenter">{{ simpleepisodestats.correctpredictions }}</td>
					<td class="bgblack  padlr4 textleft fggreen4">Seers</td>
					<td class="bgblack"></td>
				</tr>
			</table>
		</div>
		
		{% endif %}
		
		<div class="halfspacer"></div>
		
		{% if user.player.show_help_text %}
			<div class="pad4 textleft">
				Mouseover the table to see movement and delta.  Mouseover a player to see their team.
			</div>
		{% endif %}
		<div class="bgdarkgrey rounded pad2 datashow">
			<div class="textleft fglightgrey font24 pad4 rounded marg1">Leaderboard</div>
			<table class="textcenter">
				<tr>
					<td class="bgblack padlr4 fglightgrey width32"><div class="pad0 datahide">±</div></td>
					<td class="bgblack padlr4 fglightgrey">Place</td>
					<td class="bgblack padlr8 fglightgrey"></td>
					<td class="bgblack padlr4 fglightgrey">Points</td>
					<td class="bgblack padlr4 fglightgrey width32"><div class="pad0 datahide">Δ</div></td>
				</tr>
				{% for spe in simpleplayerepisodes %}
				<tr class="teamshow">
					<td class="bgblack padlr4 width32 {% if spe.movement > 0 %} fggreen5{% elif spe.movement < 0 %} fgred5{% endif%}"><div class="pad0 datahide">{% if spe.movement > 0 %}+{% endif %}{{ spe.movement }}</div></td>
					<td class="bgwhite padlr4">{{ spe.place }}</td>
					<td class="bgblack padlr8 textleft">
						<a href="{% url 'season31:player' spe.playerid %}" class="fgwhite">{{ spe.playername }}</a>
						{% if spe.vote_off_score > 0 and latestepisode.is_locked%}
						<img src="{% static 'season31/images/icons/'%}CorrectVote.png" class="actionsmall marglr4" title="Correctly Predicted Vote" />
						{% endif %}
					</td>
					<td class="bgwhite padlr4">{{ spe.total_score }}</td>
					<td class="bgblack padlr4 width32 {% if spe.score_delta < 0 %} fgdelta{% endif %}"><div class="pad0 datahide">{{ spe.score_delta }}</div></td>
					{% if latestepisode.is_locked %}
					<td class="teamhide darkgreyborder" id="{{spe.playername}}">
						<table class="tablecenter darkgreyborder"><tr>
							{% for sp in spe.tpicks %}
							<td class="padlr4 castawayimgsmall darkgreyborder bg{{sp.color}}">
								<a href="{% url 'season31:castaway' sp.id %}">{{ sp.name }}</a>
							</td>
							{% endfor %}
						</tr></table>
					</td>
					{% endif %}
				</tr>
				{% endfor %}
				<tr>
					<td class="bgblack padlr4 fglightgrey width32"><div class="pad0 datahide">±</div></td>
					<td class="bgblack padlr4 fglightgrey">Place</td>
					<td class="bgblack padlr4 fglightgrey"></td>
					<td class="bgblack padlr4 fglightgrey">Points</td>
					<td class="bgblack padlr4 fglightgrey width32"><div class="pad0 datahide">Δ</div></td>
				</tr>
			</table>
		</div>
	</td>
	{% if user.is_superuser  %}
	<td class="bgadmin noborder texttop">

		<div class="bgwhite pad4 marg4">
			<form action="{% url 'season31:addepisode' %}" method="post">
				{% csrf_token %}
				<div>
					<input type="number" name="teamsize" id="teamsize" min="2" max="10" value="{{ latestepisode.team_size }}" />
					<label for="teamsize">Team Size</label>
				</div>
				<input type="submit" class="width100" value="Add Episode" />
			</form>
		</div>
		<div class="bgwhite pad4 marg4">
			<form action="{% url 'season31:backfillteams' %}" method="post">
				{% csrf_token %}
				<input type="submit" class="width100" value="Backfill Teams" />
			</form>
		</div>
		<div class="bgwhite pad4 marg4">
			<form action="{% url 'season31:tallyalljsps' %}" method="post">
				{% csrf_token %}
				<input type="submit" class="width100" value="Tally All JSPs" />
			</form>
		</div>
		<div class="bgwhite pad4 marg4">
			<form action="{% url 'season31:updatescores' %}" method="post">
				{% csrf_token %}
				<input type="submit" class="width100" value="Recalculate All Scores" />
			</form>
		</div>
	</td>
	{% endif %}
	
</tr></table>